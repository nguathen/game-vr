import{a}from"./audio-manager-BRKiiRd-.js";const r={timeAttack:{id:"timeAttack",name:"Time Attack",description:"60 seconds ‚Äî score as high as you can!",icon:"‚è±Ô∏è",duration:60,lives:1/0,spawnInterval:1500,maxTargets:8,targetLifetime:5e3,xpMultiplier:1,unlockLevel:1},survival:{id:"survival",name:"Survival",description:"3 lives ‚Äî miss a target, lose a life!",icon:"‚ù§Ô∏è",duration:1/0,lives:3,spawnInterval:2e3,maxTargets:6,targetLifetime:4e3,xpMultiplier:1.5,unlockLevel:2},zen:{id:"zen",name:"Zen Mode",description:"No timer, no pressure ‚Äî just practice",icon:"üßò",duration:1/0,lives:1/0,spawnInterval:2500,maxTargets:5,targetLifetime:8e3,xpMultiplier:.5,unlockLevel:1},bossRush:{id:"bossRush",name:"Boss Rush",description:"Face increasingly tough boss targets!",icon:"üëπ",duration:1/0,lives:5,spawnInterval:3e3,maxTargets:4,targetLifetime:6e3,xpMultiplier:2,unlockLevel:8}};class h{constructor(){this._current="timeAttack",this._lives=1/0,this._listeners=[]}get current(){return r[this._current]}get currentId(){return this._current}get lives(){return this._lives}get all(){return r}select(t){return r[t]?(this._current=t,this._notify(),!0):!1}startRound(){this._lives=this.current.lives}loseLife(){return this._lives===1/0?!1:(this._lives--,this._notify(),this._lives<=0)}isGameOver(t){return this._lives!==1/0&&this._lives<=0||this.current.duration!==1/0&&t<=0}isUnlocked(t,e){const i=r[t];return i&&e>=i.unlockLevel}onChange(t){this._listeners.push(t)}_notify(){this._listeners.forEach(t=>t(this.current))}}const _=new h,o={doublePoints:{duration:1e4,color:"#00ff88",icon:"2X",label:"DOUBLE POINTS!"},freezeTime:{duration:5e3,color:"#00d4ff",icon:"‚ùÑ",label:"TIME FREEZE!"},multiShot:{duration:1e4,color:"#ff44aa",icon:"√ó3",label:"MULTI-SHOT!"}},c=Object.keys(o);class p{constructor(){this._active=new Map,this._hudInterval=null,this._onUpdate=null,this._onDeactivate=null}set onUpdate(t){this._onUpdate=t}set onDeactivate(t){this._onDeactivate=t}activate(t){const e=o[t];if(!e)return;this._active.has(t)&&clearTimeout(this._active.get(t).timeout);const i=Date.now(),s=setTimeout(()=>this.deactivate(t),e.duration);this._active.set(t,{timeout:s,startTime:i,config:e}),a.playPowerUp(),document.dispatchEvent(new CustomEvent("powerup-activate",{detail:{type:t,config:e}})),this._startHudUpdates()}deactivate(t){var i;const e=this._active.get(t);e&&(clearTimeout(e.timeout),this._active.delete(t),a.playPowerUpEnd(),(i=this._onDeactivate)==null||i.call(this,t),document.dispatchEvent(new CustomEvent("powerup-deactivate",{detail:{type:t}})),this._active.size===0&&this._stopHudUpdates())}isActive(t){return this._active.has(t)}getMultiplier(){return this._active.has("doublePoints")?2:1}getProjectileMultiplier(){return this._active.has("multiShot")?3:1}isTimeFrozen(){return this._active.has("freezeTime")}activateRandom(){const t=c[Math.floor(Math.random()*c.length)];return this.activate(t),{type:t,config:o[t]}}getActiveDisplay(){if(this._active.size===0)return null;let t=null,e=0;for(const[i,s]of this._active)if(s.startTime>=e){e=s.startTime;const u=Math.max(0,s.config.duration-(Date.now()-s.startTime));t={type:i,label:s.config.label,color:s.config.color,remaining:u}}return t}reset(){for(const[,t]of this._active)clearTimeout(t.timeout);this._active.clear(),this._stopHudUpdates()}_startHudUpdates(){this._hudInterval||(this._hudInterval=setInterval(()=>{var e;const t=this.getActiveDisplay();(e=this._onUpdate)==null||e.call(this,t)},100))}_stopHudUpdates(){var t;this._hudInterval&&(clearInterval(this._hudInterval),this._hudInterval=null),(t=this._onUpdate)==null||t.call(this,null)}}const d=new p,n={pistol:{id:"pistol",name:"Pistol",description:"Balanced precision shooter",icon:"üî´",damage:1,fireRate:0,spread:0,projectiles:1,laserColor:"#ff4444",laserOpacity:.7,hapticIntensity:.3,hapticDuration:50,unlockLevel:1,sound:"pistol"},shotgun:{id:"shotgun",name:"Shotgun",description:"Wide spread, hits multiple targets",icon:"üí•",damage:1,fireRate:800,spread:.15,projectiles:5,laserColor:"#ff8800",laserOpacity:.5,hapticIntensity:.8,hapticDuration:100,unlockLevel:3,sound:"shotgun"},sniper:{id:"sniper",name:"Sniper",description:"Slow fire, double points",icon:"üéØ",damage:2,fireRate:1500,spread:0,projectiles:1,laserColor:"#00ff88",laserOpacity:.9,hapticIntensity:.6,hapticDuration:80,unlockLevel:5,sound:"sniper"}};class v{constructor(){this._current="pistol",this._lastFireTime=0,this._listeners=[]}get current(){return n[this._current]}get currentId(){return this._current}get all(){return n}select(t){return n[t]?(this._current=t,this._notify(),!0):!1}canFire(){const t=this.current;return t.fireRate===0?!0:Date.now()-this._lastFireTime>=t.fireRate}fire(){if(!this.canFire())return null;this._lastFireTime=Date.now();const t=this.current;a.playWeaponFire(t.sound);const e=d.getProjectileMultiplier();return e>1&&t.projectiles===1?{...t,projectiles:e,spread:.12}:t}isUnlocked(t,e){const i=n[t];return i&&e>=i.unlockLevel}getLockedWeapons(t){return Object.values(n).filter(e=>t<e.unlockLevel)}getUnlockedWeapons(t){return Object.values(n).filter(e=>t>=e.unlockLevel)}onChange(t){this._listeners.push(t)}_notify(){this._listeners.forEach(t=>t(this.current))}}const m=new v;export{r as G,n as W,_ as g,d as p,m as w};
